% 离散傅里叶变换

\subsection{结论}
\pentry{幺正矩阵， 傅里叶变换（指数函数）\upref{FTExp}} % 链接未完成

\bb{离散傅里叶变换（Discrete Fourier Transform）（DFT）}是一个复数域的线性变换\upref{LTrans}． 对两组有序数列 $f_0, f_1, \dots, f_{N-1}$ 和 $g_0,g_2,\dots, g_{N-1}$，正变换和逆变换分别为\footnote{工程上的定义常常是正变换没有 $1/\sqrt{N}$ 因子，逆变换的 $1/\sqrt{N}$ 因子变为 $1/N$． 这样的好处是节省运算量．本书中使用的定义好处是变换为幺正变换，有保持归一化的特点．}
\begin{align}
g_p &= \frac{1}{\sqrt{N}}\sum_{q=0}^{N-1} \exp(-\frac{2\pi\I}{N} p q ) f_q \\
f_q &= \frac{1}{\sqrt{N}}\sum_{p=0}^{N-1} \exp(\frac{2\pi\I}{N} p q) g_p
\end{align}

一个更常见的名词是\bb{快速傅里叶变换（FFT）}， 其定义与离散傅里叶变换一样，只是优化了算法使程序运行更快\footnote{参考 Numerical Recipes 3ed}．

\subsection{变换矩阵}
把 DFT 和逆变换用矩阵% 幺正矩阵链接未完成
 $\mat F$ 和 $\mat F^{-1}$ 来表示， 令列矢量 $\vec f = (f_0,f_1,\dots,f_N)\Tr$， $\vec g = (g_1,g_2,\dots,g_N)\Tr$， 变换和逆变换分别记为
\begin{equation}
\vec g = \mat F \vec f \qquad
\vec f = \mat F^{-1} \vec g
\end{equation}
其中
\begin{equation}
F_{pq} = \frac{1}{\sqrt{N}} \exp(-\frac{2\pi\I}{N} p q) \qquad
\mat F^{-1} = \mat F\Her
\end{equation}
可以证明， $\mat F$ 是一个幺正矩阵， 所以有
% 未完成：正交矩阵的逆矩阵
% 未完成：凡是证明以前，真的至少应该说明一下这玩意有什么用，从哪来吧！任何词条都是啊！

\subsection{证明 $\mat F$ 的正交性}
根据正交矩阵的定义，我们需要证明
\begin{equation}
\sum_{p=0}^{N-1} F^*_{pq_1} F_{pq_2} = 0 \quad (q_1 \ne q_2)
\end{equation}
而
\begin{equation}\label{DFT_eq1}
\sum_{p=0}^{N-1} F^*_{pq_1}F_{pq_2}
= \sum_{p=0}^{N-1} \exp[\frac{2\pi\I}{N} (q_2-q_1) p]
\end{equation}
注意到求和的每一项在复平面上都对应模长为 1， 幅角为 $(q_2-q_1)p/N$ 个圆周的矢量，% 未完成：这个几何意义要在复数的加法以及指数函数（复数）中介绍！
而 $N$ 条矢量恰好向不同方向均匀分布，所以相加为 $0$．证毕．

\subsection{逆矩阵}
先来看矩阵各列的模长平方，即\autoref{DFT_eq1} 中 $q_1 = q_2$ 的情况，易得任何一列的模长平方都为 $N$．所以矩阵 $\mat F$ 是一个幺正矩阵 $\mat U$ 乘以 $\sqrt{N}$．考虑到幺正矩阵的逆矩阵是其厄米共轭， %链接未完成
有
\begin{equation}
\mat F\Her \mat F = \sqrt{N}^2 \mat U\Her \mat U = N \mat U^{-1} \mat U = N
\end{equation}
两边除以 $N$，可得 $\mat F^{-1} = \mat F\Her /N$． 证毕．
% 未完成：在逆矩阵的介绍中应该说明用常数表示常数乘以单位矩阵

有时为了对称起见，把矩阵元定义为
\begin{equation}
F_{pq} = \frac{1}{\sqrt{N}}\exp(-\frac{2\pi\I}{N} p q)
\end{equation}
这样，$\mat F$ 的每一列模长为1，使 $\mat F$ 本身就是幺正矩阵，其逆矩阵等于厄米共轭．

\subsection{用离散傅里叶变换近似傅里叶变换}
在数值计算傅里叶变换 %未完成：链接
时，不可能计算连续的频谱 $g(k)$，只能用数值积分计算离散值 $g(k_i)$
\begin{equation}
g(k_i) = \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{+\infty} f(x)\E^{-\I kx} \dd{x}
\end{equation}
为了节省计算量，我们假设
% 未完成：艾玛，这个过程要推出来真的好麻烦啊！！



。。。

总之结论就是
\begin{equation}
N\Delta x \Delta k = L_x \Delta k = L_k \Delta x = 2\pi
\end{equation}
所以离散傅里叶变换只有两个自由度， 即， 只要决定 $N, L_x, \Delta x, L_k, \Delta k$ 中的任意两个， 就可以完全决定变换矩阵。 另外注意 $x$ 的长度决定 $k$ 的密度， $k$ 的长度决定 $x$ 的密度。


\subsection{采样定理（Sampling Theorem）}
以上的离散傅里叶变换看似只是一种近似， 且有种种限制， 例如我们想既规定 $L_x$， 又减小 $\Delta k$。 使我们不禁想定义更广义的离散傅里叶变换为
\begin{equation}\ali{
g(k_j) = \frac{1}{\sqrt{2\pi}}\sum_i f(x_i) \E^{-\I k_j x_i}\Delta x\\
f(x_i) = \frac{1}{\sqrt{2\pi}}\sum_j g(k_j) \E^{\I k_j x_i}\Delta k
}\end{equation}
（其中相邻的 $x_i$ 间距为 $\Delta x$， 相邻的 $k_j$ 间距为 $\Delta_k$。 但事实上， 这样的定义并不比离散傅里叶变换好， 不仅更慢， 而且更不精确（即使 $\Delta$ 非常小）。

接下来我们要介绍非常强大的\bb{采样定理}， 并得出一个惊人的结论， 即只要 $f(x)$ 和 $g(k)$ 不超出 $L_x$ 和 $L_k$ 的范围， DFT 就是精确的傅里叶变换。

采样定理说的是， 如果 $g(k)$ 不超出 $[-L_k/2, L_k/2]$， 那么我们只需要用 $\Delta x = 2\pi/L_k$ 来对  $f(x)$  采样就可以用以下插值公式精确还原出 $f(x)$\footnote{其实我并不确定是否需要 $x_0 = 0$ 或者 $x_i$ 的位置有什么其他要求， 现在姑且认为 $x_0 = 0$ 好了。}
\begin{equation}
f(x) = \sum_{n = -\infty}^{\infty} f(x_n)\sinc[\pi(x - x_n)/\Delta x]
\end{equation}
其中 $\sinc x = \sin x/x$ （且定义 $\sinc 0 = 1$）。

现在我们将插值公式代入傅里叶变换得
\begin{equation}
g(k) =  \frac{1}{\sqrt{2\pi}} \sum_{n = -\infty}^{\infty} f(x_n) \int_{-\infty}^{+\infty}\sinc[\pi(x - x_n)/\Delta x] \E^{-\I k x} \dd{x}
\end{equation}
结果是
\begin{equation}
g(k) = \frac{1}{\sqrt{2\pi}} \sum_{n = -\infty}^{\infty} f(x_n) \E^{-\I kx_n} \Delta x
\end{equation}
注意 $g(k)$ 是完全精确的。 另外， 既然傅里叶变化和反傅里叶变换是对称的， 我们同样可得频率步长只需取 $\Delta k = 2\pi/ L_x$。 而 DFT 恰好符合这两个条件。 最后， $g(k)$ 的插值公式同样为

\begin{equation}
g(k) = \sum_{n = -\infty}^{\infty} g(k_n)\sinc[\pi(k - k_n)/\Delta k]
\end{equation}

其实单纯的无损 DFT 效率还不是最高的，例如有时候 $k_{max}-k_{min}$ 很窄， 但 $L_k$ 却很大， 这时用 $\Delta x = 2\pi/L_k$ 的效率就很低。 同理， 如果 $x_{max} - x_{min} < L_x$ 时效率也会变低。 所以与其直接对 $f(x)$ 和 $g(k)$ 使用 DFT 不如先定义
\begin{equation}
x_0 = (x_{min} + x_{max})/2 \qquad k_0 = (k_{min} + k_{max})/2
\end{equation}
然后进行以下傅里叶变换
\begin{equation}
f(x+x_0)\E^{-\I k_0 x} \Leftrightarrow g(k+k_0)\E^{\I k x_0}
\end{equation}
完了再除以指数因子及平移。

