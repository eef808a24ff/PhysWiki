%开普勒第一定律的证明

\subsection{数学模型}
由于太阳质量远大于其他行星，近似认为太阳不动．由于太阳和行星相对于行星轨道来说大小可以忽略，把它们当做质点（另见球体的平方反比力）．%未完成链接
以太阳为原点建立平面极坐标系，行星在该平面上运动，且仅受万有引力一个外力．现证明行星的运动轨迹是椭圆，且焦点在原点．

\subsection{结论}
行星轨道是以中心天体为焦点的任意圆锥曲线\footnote{所以行星轨道不一定是椭圆， 也可以是抛物线或者双曲线， 但是抛物线或双曲线轨道是从无穷远来到无穷远去的轨道， 不会绕中心天体旋转． 所以开普勒定律作为行星运动的经验公式，只描述了椭圆．}．极坐标中，圆锥曲线的方程\upref{Cone}
为
\begin{equation}\label{Keple1_eq1}
r = \frac{p}{1 - e \cos \theta }
\end{equation}
令太阳中心天体在坐标原点，则行星沿该轨道运行．

\subsection{证明（LRL 矢量）}
\pentry{拉普拉斯—龙格—楞次矢量\upref{LRLvec}}

我们先来看一种无需微分方程的推导， 将开普勒问题中的 LRL 矢量 $\vec A$ 点乘位矢 $\vec r$ 得
\begin{equation}\label{Keple1_eq17}
\vec A \vdot \vec r = (\vec p \cross \vec L)\vdot \vec r - mkr
\end{equation}
由矢量混合积公式\autoref{TriVM_eq1}\upref{TriVM}， 右边第一项为
\begin{equation}
(\vec p \cross \vec L)\vdot \vec r = (\vec r \cross \vec p)\vdot \vec L = L^2
\end{equation}
令 $\theta$ 为从 $\uvec A$ 转向 $\uvec r$ 的夹角， 则\autoref{Keple1_eq17} 变为
\begin{equation}
Ar\cos\theta = L^2 - mkr
\end{equation}
可得极坐标中的轨道为圆锥曲线的极坐标方程\footnote{对比\autoref{Keple1_eq1}会发现分母的正负号反了， 这相当于把圆锥曲线旋转了 180°，并不影响形状．}
\begin{equation}
r(\theta) = \frac{p}{1 + e\cos\theta}
\end{equation}
其中通径为 $p = L^2/(mk)$， 离心率为 $e = A/(mk)$．

\subsection{证明（轨道方程）}
\pentry{圆锥曲线的极坐标方程\upref{Cone}，极坐标加速度\upref{PolA}，牛顿第二定律\upref{New3}， 二阶常系数非齐次微分方程的通解\upref{Ode2N}}

极坐标中径向和角向加速度公式%未完成链接
分别为
\begin{equation}\label{Keple1_eq2}
a_r = \dv[2]{r}{t} - r \qty( \dv{\theta}{t} )^2
\end{equation}
\begin{equation}\label{Keple1_eq3}
a_\theta = \frac{1}{r} \dv{t} \qty(r^2\dv{\theta}{t} )
\end{equation}
根据牛顿第二定律和万有引力定律，%未完成链接
由于行星只受到沿径向的万有引力，则有
\begin{equation}\label{Keple1_eq4}
m a_r =  - G\frac{Mm}{r^2}
\end{equation}
\begin{equation}\label{Keple1_eq5}
m a_\theta = 0
\end{equation}
在\autoref{Keple1_eq4} 和\autoref{Keple1_eq5} 中同除 $m$，  代入\autoref{Keple1_eq2} 和\autoref{Keple1_eq3} 得
\begin{equation}\label{Keple1_eq6}
\dv[2]{r}{t} - r \qty( \dv{\theta}{t} )^2 =  - \frac{GM}{r^2}
\end{equation}
\begin{equation}\label{Keple1_eq7}
\dv{t} \qty( r^2 \dv{\theta}{t} ) = 0
\end{equation}
现在用\autoref{Keple1_eq6}， \autoref{Keple1_eq7} 消去 $t$．\autoref{Keple1_eq7} 括号内部不随时间变化，令其等于常数 $h$
\begin{equation}\label{Keple1_eq8}
r^2 \dv{\theta}{t} = h
\end{equation}
其中 $h$ 为任意常数．我们想得到 $r$ 关于 $\theta$ 的微分方程，就要把所有的时间导数消去．首先可以把 $r$ 看做复合函数 $r[\theta(t)]$， 再用链式法则\upref{ChainR}把\autoref{Keple1_eq6} 的第一项用 $\dv*{\theta}{t}$ 表示
\begin{equation}\label{Keple1_eq10}\ali{
\dv[2]{r}{t} & = \dv{t} \qty( \dv{r}{t} ) = \dv{t} \qty( \dv{r}{\theta} \dv{\theta}{t} ) = \dv{\theta}\qty( \dv{r}{\theta} ) \qty( \dv{\theta}{t} )^2 + \dv{r}{\theta}\dv[2]{\theta}{t}\\
& = \dv[2]{r}{\theta} \qty( \dv{\theta}{t} )^2 + \dv{r}{\theta}\dv{\theta} \qty( \dv{\theta}{t} )\dv{\theta}{t}
}\end{equation}
然后把\autoref{Keple1_eq8} 两边同除 $r^2$ 并代入\autoref{Keple1_eq6} 消去所有时间导数，
得到 $r$ 关于 $\theta$ 的微分方程
\begin{equation}
\dv[2]{r}{\theta} \qty( \frac{h}{r^2} )^2 + \dv{r}{\theta}\dv{\theta} \qty( \frac{h}{r^2} )\frac{h}{r^2} - r \qty( \frac{h}{r^2} )^2 =  - \frac{GM}{r^2}
\end{equation}
化简得
\begin{equation}\label{Keple1_eq12}
\frac{h^2}{r^4} \qty[ \dv[2]{r}{\theta} + r^2\dv{r}{\theta}\dv{\theta} \qty( \frac{1}{r^2} ) - r ] =  - \frac{GM}{r^2}
\end{equation}
这就是 $r$ 关于 $\theta $ 的微分方程

将\autoref{Keple1_eq1} 代入，可验证\autoref{Keple1_eq1} 是该方程的解．当然，在事先不知道轨道方程的情况下，也可以直接解该方程．令
\begin{equation}\label{Keple1_eq13}
u \equiv \frac{1}{r}
\end{equation}
代入\autoref{Keple1_eq12}，  得到 $u$ 关于 $\theta $ 的微分方程
\begin{equation}\label{Keple1_eq15}
h^2 \qty( \dv[2]{u}{\theta} + u ) =  GM
\end{equation}
这就是\bb{比耐公式}，是一个二阶常系数非齐次微分方程， 通解\upref{Ode2N}为
\begin{equation}
u = \frac{1}{p} \qty[1 - e\cos(\theta  + \varphi)]
\end{equation}
其中
\begin{equation}
p = \frac{h^2}{GM}
\end{equation}
$e, \varphi, h$ 为任意常数．写成关于 $r$ 的函数， 得到圆锥曲线
\begin{equation}\label{Keple1_eq16}
r = \frac{p}{1 - e \cos \theta }
\end{equation}
证毕．
\rentry{比耐公式\upref{Binet}}
