%直积空间

\pentry{傅里叶级数与矢量空间， 二维傅里叶级数}

\subsection{定义}

我们以二维傅里叶级数来引入直积的概念。 我们已知一维函数的傅里叶级数展开可以看做是一个矢量在一组正交归一基底上的展开， 自然地， 我们也希望能从矢量的空间的角度理解二维傅里叶级数展开。 为了讨论方便， 我们只讨论可以用有限项傅里叶级数展开的函数。

如果 $x$ 和 $y$ 方向分别取 $N_x$ 和 $N_y$ 个函数基底， 那么二维傅里叶级数中就有 $N_xN_y$ 个基底， 即被展开的函数是一个 $N_xN_y$ 维空间中的矢量。

观察二维傅里叶级数中的函数基底可以发现， 每一个基底都是一个 $N_x$ 维空间中的 $x$ 基底和一个 $N_y$ 维空间中的 $y$ 基底的乘积。 从矢量的角度来看， 这是一种以前没有见过的矢量乘法， 它既不是数乘%链接未完成
（得到同维度的矢量）也不是内积%链接未完成
（得到标量）， 而是将两个不同矢量空间中的矢量相乘得到一个更高维空间中的矢量， 使新矢量的维度等于前两个矢量各自的维度相乘。 我们把这样的矢量乘法叫做\bb{直积}， 记为
\begin{equation}
\ket{v} = \ket{x} \otimes \ket{y}
\end{equation}
我们把直积得到的矢量所在的空间叫做\bb{直积空间}。 为了书写方便我们时常省略直积号记为 $\ket{x}\ket{y}$， 或者将直积的结果记为一个整体 $\ket{v} = \ket{x, y}$。 为了让读者熟悉， 下文会随机使用这两种符号。

我们定义直积满足\bb{交换律}， 正如我们认为 $f_x(x)f_y(y) = f_y(y)f_x(x)$\footnote{虽然从概念上交换律成立， 但是为了避免混淆我们还是应该规定一个书写顺序， 比统一用 $x$ 空间的矢量直积 $y$ 空间的矢量。}。

我们将两个一维傅里叶变换空间中的基底分别为 $\{\ket{x_i}\}$ 和 $\{\ket{y_j}\}$， 那么我们定义直积空间为基底 $\{\ket{x_i}\ket{y_j}\}$ 张成的空间， 里面的任意矢量都可以用基底展开。
\begin{equation}
\ket{v} = \sum_{i,j} C_{ij}\ket{x_i, y_j}
\end{equation}

定义直积满足\bb{结合律}， 即两个低维空间中任意各选一个矢量 $\ket{x}$ 和 $\ket{y}$， 它们都可以在各自空间的基底中展开， 则它们的直积为
\begin{equation}\label{DirPro_eq2}
\ket{x}\ket{y} = \sum_i a_i\ket{x_i} \sum_j b_j\ket{y_j}
= \sum_{i,j} a_i b_j \ket{x_i, y_j}
\end{equation}

注意直积空间的的任意一个矢量不一定可以分解为两个矢量的直积。 例如 $\ket{x_1}\ket{y_1} + 2\ket{x_2}\ket{y_3}$ 就不能由直积得到。 也可类比函数的情况， $f_x(x)f_y(y)$ 可以记为 $f(x, y)$， 但 $f(x, y)$ 不一定能记为 $f_x(x)f_y(y)$。

任何矢量空间的基底都需要有固定的顺序， 排序可以是任意的， 但是一旦确定在所有的计算中都不能改变。 %未完成：这句话应该放到更早的词条。
直积基底通常按照以下两种方式排序\footnote{由于这里每个基底都有两个角标， 使初学者有把基底排成长方形的冲动， 这是错误的。}
\begin{equation}\label{DirPro_eq4}
\qty{\ket{x_1, y_1}, \ket{x_1, y_2}\dots  \ket{x_2, y_1}, \ket{x_2, y_2}\dots }
\end{equation}
\begin{equation}\label{DirPro_eq5}
\qty{\ket{x_1, y_1}, \ket{x_2, y_1}\dots  \ket{x_1, y_2}, \ket{x_2, y_2}\dots }
\end{equation}
排序以后， 我们就可以用单下标来区分不同的基底， 令
\begin{equation}
\ket{x, y}_\alpha = \ket{x_i, y_j}
\end{equation}
对应两种排序， 分别有
\begin{equation}
\alpha = N_y (i-1) + j
\quad \text{或} \quad
\alpha = i + N_x (j-1)
\qquad 
(1 \les \alpha \les N_xN_y)
\end{equation}

\subsection{矢量的内积}

若我们需要在直积空间中讨论模长和正交这样的概念就必须先定义\bb{内积}： 直积空间中两矢量（先假设它们可以分解为直积， 比如两个基底矢量）的内积等于把每个低维空间中对应矢量分别做内积再相乘。 即 $\ket{c}\ket{d}$ 和 $\ket{a}\ket{b}$ 的内积为
\begin{equation}
\qty(\bra{d}\bra{c})\qty(\ket{a}\ket{b})
= \bra{d}\braket{c}{a}\ket{b}
= \braket{c}{a}\braket{d}{b}
\end{equation}
注意 $\ket{c}\ket{d}$ 的厄米共轭%未完成
记为 $\bra{d}\bra{c}$ 而不是 $\bra{c}\bra{d}$。 这样就可以很容易看出需要把 $\braket{c}{a}$ 组合做内积而不是 $\braket{d}{a}$。 但如果把两矢量记为 $\ket{a, b}$ 和 $\ket{c, d}$， 那么内积记为\footnote{书写习惯上，ket 和对应的 bra 中的记号应保持相同。所以 $\ket{c, d}$ 的厄米共轭记为 $\bra{c, d}$ 而不是 $\bra{d, c}$。}
\begin{equation}
\bra{c, d}\ket{a, b} = \braket{c}{a}\braket{d}{b}
\end{equation}

直积空间中的内积是否满足交换律取决于两个低维空间中的内积是否满足交换律。 一般情况下， $\braket{u}{v} = \braket{v}{u}^*$， 所以直积空间中的也有
\begin{equation}
\bra{a, b}\ket{c, d} = \braket{a}{c}\braket{b}{d}
= \braket{c}{a}^*\braket{d}{b}^* = \bra{c, d}\ket{a, b}^*
\end{equation}

如果两个低维空间中的基底都是正交归一的， 那么直积空间中的基底也是正交归一的
\begin{equation}
\bra{x_{i'}, y_{j'}}\ket{x_i, y_j} = \braket{x_{i'}}{x_i}\braket{y_{j'}}{y_j}
= \delta_{i,i'}\delta_{j,j'}
\end{equation}
以后我们一般讨论正交归一基底。

知道了直积空间基底之间的内积后， 要计算直积空间中任意两个矢量的内积， 只需先将它们分解到基底上， 再按照内积的分配律和正交归一化条件即可得到熟悉的内积公式
\begin{equation}\ali{
\braket{x}{y} &= \qty(\sum_{i',j'} C'^*_{i',j'}\bra{y_{j'}}\bra{x_{i'}}) \qty( \sum_{i,j} C_{i,j} \ket{x_{i'}}\ket{y_{j'}}) \\
&= \sum_{i',j'} \sum_{i,j} C'^*_{i',j'} C_{i,j} \delta_{i,i'}\delta_{j,j'}
= \sum_{i,j} C'^*_{i,j} C_{i,j}
}\end{equation}

正交归一基底的\bb{完备性}%未完成引用矢量空间的对应公式
仍然可以记为
\begin{equation}\label{DirPro_eq13}
\sum_{i,j} \ket{x_i, y_j} \bra{x_i, y_j} = \mat I
\end{equation}
其中 $\mat I$ 是直积空间的单位算符。

我们现在从直积空间的角度来看二维傅里叶级数， 将被展开的函数记为矢量 $\ket{f}$， 则
\begin{equation}\label{DirPro_eq14}
\ket{f} = \sum_\alpha C_{i,j}\ket{x, y}_\alpha = \sum_{i,j} C_{i,j}\ket{x_i, y_j}
\end{equation}
其中
\begin{equation}\label{DirPro_eq15}
C_{i,j} = \int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} f_{x,i}(x) f_{y,j}(y) f(x, y) \dd{x}\dd{y}
= \braket{x_i, y_j}{f}
\end{equation}
我们可以验证基底的完备性（\autoref{DirPro_eq13}）， 将\autoref{DirPro_eq15} 代入\autoref{DirPro_eq14} 得
\begin{equation}
\ket{f} = \sum_{i,j} \ket{x_i, y_j}\braket{x_i, y_i}{f}
= \qty(\sum_{i,j} \ket{x_i, y_j}\bra{x_i, y_i})\ket{f}
\end{equation}
由于 $\ket{f}$ 是任意的， 这就间接证明了
\begin{equation}\label{DirPro_eq14}
\sum_\alpha \ket{x_i, y_j}\bra{x_i, y_i} = \mat I
\end{equation}

若直积空间中一个矢量可以表示为两个低维空间矢量的直积  $\ket{u}\ket{v}$， 则其基底展开为
\begin{equation}
\ket{u}\ket{v} = \qty(\sum_i a_i\ket{u_i}) \otimes \qty(\sum_j b_j \ket{u_j})
= \sum_{i,j} a_i b_j \ket{u_i, u_j}
\end{equation}

\subsubsection{直积空间的子空间}
令 $\ket{u_i}$ 和 $\ket{v_j}$ 分别为两个低维空间的基底， 则直积空间中存在两种“天然”的子空间。 % 未完成：线性代数介绍子空间
一种将直积基底根据 $i$ 的分成许多组， 每组张成一个子空间。 同理， 也可以根据 $j$ 来划分子空间． 我们姑且分别称它们为 $u$ 子空间和 $v$ 子空间．

\subsubsection{算符}
两个低维空间的线性算符 $\Q A$ 和 $ \Q B$ 做直积可以得到直积空间中的算符 $\Q A \otimes \Q B$。 我们定义 $\Q A \otimes \Q B$ 为线性算符， 该算符对任意基底的作用结果为
\begin{equation}
\Q A \otimes \Q B \ket{u_i, v_j} = (\Q A \ket{u_i}) \otimes (\Q B \ket{v_j})
\end{equation}
要对任意矢量作用， 只需将矢量记为直积基底的线性组合， 然后再分别对直积基底作用即可．

特殊地， 可以用 $\Q A \otimes \Q I$ 运算将 $\{\ket{u_i}\}$  空间中的 $\Q A$ 拓展到直积空间中来
\begin{equation}
\Q A \otimes \Q I \ket{u_i, v_j} = (\Q A \ket{u_i}) \otimes \ket{v_j}
\end{equation}
这说明算符 $\Q A \otimes \Q I$ 在每个 $v$ 子空间中都是闭合的． 所以， 算符 $\Q A \otimes \Q I$ 作用在直积空间的任意矢量上， 相当于 $\Q A \otimes \Q I$ 对该矢量在各个子空间中的分量分别作用． $\Q B$ 也同理，不再赘述。 根据定义， 不难证明
\begin{equation}
(\Q A \otimes \Q I)(\Q I \otimes \Q B) = (\Q I \otimes \Q B)(\Q A \otimes \Q I) = \Q A \otimes \Q B
\end{equation}

\subsubsection{矩阵元的计算}
若直积空间中的基底正交归一， 则直积算符矩阵元为
\begin{equation}\ali{
(\Q A \otimes \Q B)_{\alpha_1, \alpha2} &= \bra{u_{i'} v_{j'}} \Q A \otimes \Q B \ket{u_i v_j} = \bra{u_{i'} v_{j'}} (\Q A \ket{u_i} \otimes \Q B \ket{v_j}) \\
&= \bra{u_{i'}} \Q A \ket{u_i} \bra{v_{j'}} \Q B \ket{v_j}
}\end{equation}

注意矩阵元的计算与基底的排序有关， 如果按照\autoref{DirPro_eq4} 排序， 则每个 $u$ 子空间的基底都在一起。 现在用分块矩阵的概念， 若把矢量根据 $u$ 子空间分成一段段， 每一段是 $u$ 子空间中分量的系数， 矩阵也会分成一些正方形的小块， 第 $(m, n)$ 小块中为
\begin{equation}
A_{mn} \mat B
\end{equation}
所以， $\Q A \otimes \Q B$ 的矩阵是把 $\mat A$ 的每个矩阵元 $A_{mn}$ 拓展成矩阵分块 $A_{mn} \mat B$．

同理， 若基底以\autoref{DirPro_eq5} 排序， 即每个 $v$ 子空间的基底都在一起， 则  $(\Q A \otimes \Q B)$ 的矩阵就是把 $\mat B$ 的每个矩阵元 $B_{mn}$ 拓展成矩阵分块 $B_{mn} \mat A$． 

\subsection{关于本征问题的定理}%（证明未完成）
	
＊如果考虑直积空间中的本征问题， $\Q A$  的本征矢 $\ket{eig_i}$ 具有 $n$ 重简并， 简并空间的基底分别为 $\ket{eig_i}\ket{v_1}, \ket{eig_i}\ket{v_2}\dots$． 

＊ $\Q A \otimes \Q B$ 的本征值共有 $m \times n$ 个， $m$ 和 $n$ 分别是 $A$ 和 $B$ 的维度， 若 $a_1, a_2,\dots, a_m$ 和 $b_1, b_2, \dots, b_n$ 分别是 $A$ 和 $B$ 的本征值， 那么 $A \otimes B$ 的本征值和本征矢分别为 $a_i b_j$ 和 $\ket{u_i, v_j}$ （$0 \les i \les m,  0 \les j \les n$）。

＊ $A \otimes I + I \otimes B$ 的本征值和本征矢分别为 $a_i + b_j$ 和 $\ket{u_i, v_j}$． 

＊ 两个厄米矩阵直积仍然是厄米矩阵．

＊l两个厄米矩阵相加仍然是厄米矩阵．
