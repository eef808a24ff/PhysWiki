% 拉格朗日例题

% 未完成： 验算 + Matlab 画图
一根无限长杆在竖直平面绕杆上某点以角速度 $\omega$ 匀速转动， 一质点可以延杆做无摩擦运动， 质点与转轴由弹簧相连， 弹性系数为 $k$， 原长为 $x_0$， 求质点的运动轨迹。

令质点离转轴的距离为 $x$ （正方向任意选取）， 令 $\omega_0^2 = \omega^2 + k/m$， 由拉格朗日方程得轨道方程
\begin{equation}
\ddot x - \omega_0^2 x = -g \sin(\omega t) - \frac{k}{m} x_0
\end{equation}


齐次解
\begin{equation}
x = C_1 x_1(t) + C_2 x_2(t) = C_1 \E^{\omega_0 t} + C_2 \E^{-\omega_0 t}
\end{equation}
非齐次解
\begin{equation}
W = \vmat{x_1 & x_2\\ x'_1 & x'_2} = -2\omega_0
\end{equation}

\begin{equation}
\int \frac{x_1 f(t)}{W} \dd{t} = \frac{g}{2\omega_0} \frac{\E^{\omega_0 t} [\omega_0 \sin(\omega t) - \omega \cos(\omega t)]}{\omega^2 + \omega_0^2} + \frac{k x_0}{2 m\omega_0^2} \E^{\omega_0 t}
\end{equation}

\begin{equation}
\int \frac{x_2 f(t)}{W} \dd{t} = -\frac{g}{2\omega_0} \frac{\E^{-\omega_0 t} [\omega_0 \sin(\omega t) + \omega \cos(\omega t)]}{\omega^2 + \omega_0^2} - \frac{k x_0}{2 m\omega_0^2} \E^{-\omega_0 t}
\end{equation}

通解为
\begin{equation}\ali{
x(t) =  &C_1 x_1 + C_2 x_2 - x_1 \int \frac{x_1 f(t)}{W} \dd{t} + x_2 \int \frac{x_2 f(t)}{W} \dd{t}\\
= &C_1 \E^{\omega_0 t} + C_2 \E^{-\omega_0 t}\\
&+\frac{g}{\omega^2 + \omega_0^2} \qty[\frac{\omega}{\omega_0} \sinh(2\omega_0 t) \cos(\omega t) - \cosh(2\omega_0 t) \sin(\omega t)]\\
&- \frac{k x_0}{m\omega_0^2} \cosh(2\omega_0 t)
}\end{equation}
