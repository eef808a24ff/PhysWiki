% 库仑函数
% 参考 https://dlmf.nist.gov/33.2\#E11．

在球坐标系中解库仑势场中的薛定谔方程， %链接未完成
会得到径向方程
\begin{equation}
\dv[2]{u}{\rho} + \qty[1 - \frac{2\eta}{\rho} - \frac{l(l+1)}{\rho^2}]u = 0
\end{equation}
其解为\bb{第一类库仑函数} $F_l(\eta, \rho)$ 和\bb{第二类库仑函数} $G_l(\eta, \rho)$。 第一类库仑函数的解析式为\footnote{这里的两套正负号是等效的}
\begin{equation}
F_l(\eta, \rho) = A_l(\eta) \rho^{l+1} \E^{\mp\I\rho} M(l+1\mp\I\eta, 2l+2, \pm 2\I\rho)
\end{equation}
其中
\begin{equation}
A_l(\eta) = \frac{2^l \E^{-\pi\eta/2} \abs{\Gamma(l+1+\I\eta)}}{(2l+1)!}
\end{equation}
$M(a, b, z)$ 是\bb{库默尔（Kummer） M 函数}， 也叫第一类合流超几何函数\upref{HypGeo}， 记为 $_1 F_1(a;b;z)$． 库仑函数也可以用\bb{惠特克（Whittaker） M 函数}来表示得更紧凑
\begin{equation}
F_l(\eta, \rho) = \qty(\frac{\mp\I 1}{2})^{l+1} A_l(\eta) M_{\pm\I\eta, l+\frac12}\qty(\pm 2\I\rho)
\end{equation}
其中惠特克 M 函数与库默尔 M 函数的关系为
\begin{equation}
M_{\kappa, \mu}(z) = \E^{-z/2} z^{\mu + 1/2} M(\mu - \kappa + 1/2, 1 + 2\mu, z)
\end{equation}
$F_l(\eta, \rho)$ 是一个实函数， 类似 $r$ 乘以第一类球贝赛尔函数\footnote{当 $\eta = 0$ 时二者相等．}， 有
\begin{equation}
F_l(\eta, 0) = 0 \qquad \eval{\dv{F_l(\eta, \rho)}{\rho}}_0 = 
\leftgroup{&A_0(\eta) &\qquad &(l = 0)\\ & 0 &\qquad &(l > 0)}
\end{equation}
且渐进形式为
\begin{equation}
\lim_{\rho\to \infty} F_l(\eta, \rho) = \sin[\rho - \pi l/2 - \eta\ln(2\rho) + \sigma_l(\eta)]
\end{equation}
其中 $\sigma_l(\eta)$ 是\bb{库仑相移（Coulomb phase shift）}
\begin{equation}
\sigma_l(\eta) = \arg[\Gamma(l+1+\I\eta)]
\end{equation}

第二类库仑函数 $G_l(\eta, \rho)$ 可以由 $H_l^\pm(\eta, \rho)$ 得到， 后者是两类库仑函数的线性组合\footnote{类比 $\exp(\I x) = \cos x + \I\sin x$}
\begin{equation}
H_l^\pm(\eta, \rho) = G_l(\eta, \rho) \pm \I F_l(\eta, \rho)
\end{equation}	
定义为
\begin{equation}\label{CulmF_eq10}
H_l^\pm(\eta, \rho) = (\mp\I)^l \E^{\pi\eta/2 \pm \I \sigma_l(\eta)} W_{\mp\I\eta, l + 1/2}(\mp 2\I\rho)
\end{equation}
其中 $W_{\kappa, \mu}(z)$ 是\bb{惠特克（Whittaker） W 函数}
\begin{equation}\label{CulmF_eq11}
W_{\kappa, \mu}(z) = \E^{-z/2} z^{\mu + 1/2} U(\mu - \kappa + 1/2, 1 + 2\mu, z)
\end{equation}
其中 $U(a, b, z)$ 是 \bb{库默尔（Kummer） U 函数}， 定义为
\begin{equation}
U(a, b, z) = \frac{\Gamma(1 - b)}{\Gamma(a + 1 - b)} M(a, b, z) + \frac{\Gamma(b - 1)}{\Gamma(a)} z^{1 - b} M(a + 1 - b, 2 - b, z)
\end{equation}
\autoref{CulmF_eq11} 代入\autoref{CulmF_eq10} 得
\begin{equation}
%未完成：这个公式是 NIST 上的，我验算是对的，但是这么表示反而更复杂， 应该把 (\mp 2\I\rho)^{l + 1 \pm\I\eta} 变成 (\mp 2\I\rho)^{l + 1}
H_l^\pm(\eta, \rho) = \E^{\pm\I\theta_l(\eta, \rho)}(\mp 2\I\rho)^{l + 1 \pm\I\eta} U(l + 1 \pm \I\eta, 2l + 2, \mp2\I\rho)
\end{equation}
其中
\begin{equation}
\theta_l(\eta, \rho) = \rho - \eta\ln(2\rho) - \frac12 l\pi + \sigma_l(\eta)
\end{equation}

我们以后将第一类库仑函数记为更直观的形式 $F_l(Z, k, r)$， 或简写为 $F_l(k, r)$． 由渐进形式可得径向归一化积分\footnote{积分时可忽略 $\sin$ 中的额外相位， 但我不会证．}与球贝赛尔函数的一样
\begin{equation}
\int_0^\infty F_l(k', r)F_l(k, r) \dd{r} = \int_0^\infty \sin(k'r)\sin(kr) \dd{r} = \frac{\pi}{2}\delta(k - k')
\end{equation}