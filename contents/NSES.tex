% 数值解一维薛定谔方程（试射法）

% 未完成： 把本词条合并到 “一维势能束缚态数值解（试射法）”

\footnote{本词条使用原子单位}用试射法解以下薛定谔方程，其中 $V(x)$ 已知
\begin{equation}
-\frac{1}{2m}\psi(x) + V(x)\psi(x) = E \psi(x)
\end{equation}
先讨论偶函数势能的情况．当 $V(x)$ 为偶函数，定态波函数为奇函数或偶函数．前者可用初始条件 $\psi(0)=0$， $\psi'(0)=1$，后者可用初始条件 $\psi(0)=1$， $\psi'(0)=0$．这样解出来的波函数一般不满足归一化条件，若需要可另行归一化．

现在可用定步长的欧拉法或者龙格库塔四阶法来解 $x\in [0, x_{max}]$ 的薛定谔方程．显然程序中不能选取 $x\in [0,+\infty]$，但是要保证 $x_{max}$ 足够大，使解出薛定谔方程后有 $\psi(x_{max})\approx 0$， $\psi'(x_{max})\approx 0$．

但如何求得本征值 $E$ 呢？一种简单的方法是试射法． 顾名思义， 取不同离散的 $E$，用一定的条件判断对这些 $E$ 波函数在 $x_{max}$ 处是否满足边界条件 $\psi(x_{max}) \approx 0$\footnote{如果 $x_{max}$ 足够大，只需满足这一条件即可自动满足 $\psi'(x_{max})\approx 0$}．

一般来说，若 $E$ 略大于某本征值 $E_n$ 时，会有 $\psi(x_{max})>0$，略小时会有 $\psi(x_{max})>0$．所以画出 $\psi(x_{max})$ 关于 $E$ 的图像，用目测法找到零点即可．若需要更精确的本征值，可选取一个更小的区间，再次画图．

若觉得这样做比较麻烦，可用多区间的二分法自动寻找以上图像中的零点，方法如下．先确定本征值所在的范围， 把该范围先等分成 $N$ 等份，在每一份的两端判断 $\psi(x_{max})$ 的符号，如果有变号，则说明该份中至少有一个零点．继而可用二分法求解零点的精确值．在这种方法中，必须保证每个小份中至多有一个零点，否则有可能漏解．检查是否漏解可以用波函数节点的数量来判断．如果节点数 $N_{node}$ 是递增的，则没有漏解．
